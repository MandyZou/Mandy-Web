<!DOCTYPE html>
<head>
    <title>Jane's Travel Map</title>

    <script src="https://d3js.org/d3.v4.min.js"></script>
    <!-- Introducing TopoJson -->
    <script src="https://unpkg.com/topojson@3.0.0"></script>

    <script src="jquery-3.2.1.min.js"></script>

    <!-- ScrollReveal -->
    <!-- // <script src="https://unpkg.com/scrollreveal/dist/scrollreveal.min.js"></script> -->

    <script src="http://www.web2feel.com/freeby/scroll-effects/assets/viewportchecker.js"></script>

    <script src="jquery.waypoints.min.js"></script>

    <script>
    $(document).ready(function(){
    var gettMap = $("#tMap");

    var tMapPosition = gettMap.position(); //Get top and let position

    $(window).scroll(function(){
        var scrollBarPosition = $(window).scrollTop();
        if (scrollBarPosition >= tMapPosition.top){
            gettMap.css({
                "position": "fixed",
                "top": 10,
            });
        }
        else {
            gettMap.css({
                "position": "fixed",
                "top": 0
            });
        };
    });

    var getCities = $("#cities1");

    var citiesPosition = getCities.position();

    $(window).scroll(function(){
        var scrollBarPosition = $(window).scrollTop();

        if (scrollBarPosition >= citiesPosition.top){
            getCities.addClass("afterScroll");
            console.log("add!")
        } else {
            // s.removeClass("afterScroll");
        }
    });

    var getCities2 = $("#cities2");

    var citiesPosition2 = getCities2.position();

    $(window).scroll(function(){
        var scrollBarPosition = $(window).scrollTop();

        if (scrollBarPosition >= (citiesPosition2.top + 120)){
            getCities2.addClass("afterScroll");
            console.log("add2!")
        } else {
            // s.removeClass("afterScroll");
        }
    });

    var getCities3 = $("#cities3");

    var citiesPosition3 = getCities3.position();

    $(window).scroll(function(){
        var scrollBarPosition = $(window).scrollTop();

        if (scrollBarPosition >= (citiesPosition3.top + 120)){
            getCities3.addClass("afterScroll");
        } else {
            // s.removeClass("afterScroll");
        }
    });

    var getCities4 = $("#cities4");

    var citiesPosition4 = getCities4.position();

    $(window).scroll(function(){
        var scrollBarPosition = $(window).scrollTop();

        if (scrollBarPosition >= (citiesPosition4.top + 180)){
            getCities4.addClass("afterScroll");
        } else {
            // s.removeClass("afterScroll");
        }
    });

    var getCities5 = $("#cities5");

    var citiesPosition5 = getCities5.position();

    $(window).scroll(function(){
        var scrollBarPosition = $(window).scrollTop();

        if (scrollBarPosition >= (citiesPosition5.top + 240)){
            getCities5.addClass("afterScroll");
        } else {
            // s.removeClass("afterScroll");
        }
    });

    var getCities6 = $("#cities6");

    var citiesPosition6 = getCities6.position();

    $(window).scroll(function(){
        var scrollBarPosition = $(window).scrollTop();

        if (scrollBarPosition >= (citiesPosition6.top + 300)){
            getCities6.addClass("afterScroll");
        } else {
            // s.removeClass("afterScroll");
        }
    });

    var getCities7 = $("#cities7");

    var citiesPosition7 = getCities7.position();

    $(window).scroll(function(){
        var scrollBarPosition = $(window).scrollTop();

        if (scrollBarPosition >= (citiesPosition7.top + 360)){
            getCities7.addClass("afterScroll");
        } else {
            // s.removeClass("afterScroll");
        }
    });

    var getCities8 = $("#cities8");

    var citiesPosition8 = getCities8.position();

    $(window).scroll(function(){
        var scrollBarPosition = $(window).scrollTop();

        if (scrollBarPosition >= (citiesPosition8.top + 420)){
            getCities8.addClass("afterScroll");
        } else {
            // s.removeClass("afterScroll");
        }
    });

    var getCities9 = $("#cities9");

    var citiesPosition9 = getCities9.position();

    $(window).scroll(function(){
        var scrollBarPosition = $(window).scrollTop();

        if (scrollBarPosition >= (citiesPosition9.top + 480)){
            getCities9.addClass("afterScroll");
        } else {
            // s.removeClass("afterScroll");
        }
    });

    var getCities10 = $("#cities10");

    var citiesPosition10 = getCities10.position();

    $(window).scroll(function(){
        var scrollBarPosition = $(window).scrollTop();

        if (scrollBarPosition >= (citiesPosition10.top + 560)){
            getCities10.addClass("afterScroll");
        } else {
            // s.removeClass("afterScroll");
        }
    });

    });

    </script>

    <style>
    html, body{
        height: 100%;
        width: 100%;
    }

   .selected {
    fill: steelblue;
   }

   #wrap {
    width: 90%;
    margin: 0 auto;
    height: 800px;
   }

   #tMap{
    width: 40%;
    float: left;
   }


   #text {
    width: 30%;
    float: right;
    padding-left: 10%;

   }

  #cities1{
    height: 50px;
    /*display: none;*/
   }

  #cities2{
    height: 50px;
    /*display: none;*/
   }

  #cities3{
    height: 50px;
    /*display: none;*/
   }

  #cities4{
    height: 50px;
    /*display: none;*/
   }

   #cities5{
    height: 50px;
    /*display: none;*/
   }

   #cities6{
    height: 50px;
    /*display: none;*/
   }

   #cities7{
    height: 50px;
    /*display: none;*/
   }

   #cities8{
    height: 50px;
    /*display: none;*/
   }

   #cities9{
    height: 50px;
    /*display: none;*/
   }

   #cities10{
    height: 50px;
/*    display: none;*/
   }

   .beforeScroll{
    display: none;
/*    width: 30%;
    float: right;
    padding-left: 10%;*/
   }

   .afterScroll {
    margin-bottom: 150%;
    display: block;
   }

    </style>

</head>
<body>
    <div id="wrap">
    <div id="tMap"></div>

    <script>
    var margin = {top: 0, left: 0, right:0, bottom: 0},
        width = 820 - margin.left - margin.right,
        height = 800 - margin.top - margin.bottom;

    var svg = d3.select("#tMap")
                .append("svg")
                    .attr("width", width)
                    .attr("height", height)
                .append("g")
                    .attr("transform", "translate(" + margin.left + "," + margin.top + ")");

    var projection = d3.geoMercator()
                    .center([107,31])
                    .scale(700)
                    .translate([width/2, height/2]);

    var path = d3.geoPath()
                .projection(projection); 

    d3.queue()
        .defer(d3.json, "china.json")
        .await(ready);

    function ready(error,data){
        if (error) throw error;

        var china = topojson.feature(data, {
            type:"GeometryCollection",
            geometries: data.objects.CHN_adm1.geometries,
        });

        svg.selectAll("path")
            .data(china.features).enter()
            .append("path")
                .attr("d", path)
            .attr("class",function(d){
                return d.properties.NAME_1;
            })
                .attr("fill", "none")
                .attr("stroke", "steelblue")
            .on("mouseover", function(d){
                d3.select(this).classed("selected", true)
            })
            .on("mousemove", function(d){
                d3.select(this).classed("selected", true)
            })
            .on("mouseout", function(d){
                d3.select(this).classed("selected", false)
            });

        // svg.selectAll("text")
        //   .data(china.features).enter()    
        // .append("text")
        //   .attr("x", function (d) { return path.centroid(d)[0]; })
        //   .attr("y", function (d) { return path.centroid(d)[1]; })
        //   .text(function (d) { return d.properties.NL_NAME_1; }); 
    };

    </script>

    <!-- Text part -->
    <div id="text">
        <h1 style="text-align: center">Jane's Travel Map</h1>

        <div id="cities1" class="beforeScroll">
            2016.01 Jiujiang, Jiangxi
        </div>

        <div id="cities2" class="beforeScroll">
            2016.03 Wuhan, Hubei; Yichun, Jiangxi
        </div>

        <div id="cities3" class="beforeScroll">
            2016.05 Beijing
        </div>

        <div id="cities4" class="beforeScroll">
            2016.07 Yichun, Jiangxi
        </div>

        <div id="cities5" class="beforeScroll">
            2016.08 Taiyuan, Xian
        </div>

        <div id="cities6" class="beforeScroll">
            2016.10 Yichun, Jiangxi
        </div>

        <div id="cities7" class="beforeScroll">
            2017.01 Hongkong; Macao; Zhuhai, Guangdong
        </div>

        <div id="cities8" class="beforeScroll">
            2017.03 Changchun, Liaoning
        </div>

        <div id="cities9" class="beforeScroll">
            2017.04 Yichun, Jiangxi
        </div>

        <div id="cities10" class="beforeScroll">
            2017.06 Chengdu, Sichuan
        </div>

    </div>
    <!-- div of text ends here -->
</div>
<!-- Div of wrap ends here -->

</body>
</html>