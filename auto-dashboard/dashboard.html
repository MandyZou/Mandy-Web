<!DOCTYPE html>
<head>
    <title>Automative Social Activity Dashboard</title>

    <script src="https://d3js.org/d3.v4.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>

    <link rel="stylesheet" type="text/css" href="main.css"></link>
    <link rel="stylesheet" type="text/css" href="meter.css"></link>
    <link rel="stylesheet" type="text/css" href="linechart.css"></link>


</head>
<body onload="document.getElementById('week').focus()">

    <div class="part1">
        <div>
            <div class="gauge-all">
                <div class="gauge">
                    <div class="meter"></div>
                </div>
                <div class="needle">
                     <div class="pointer"></div>
                </div>
            </div>
        <figcaption>Total Visitor: <span style="font-size: 80px; color: #4393E6"><strong>1,200</strong></span></figcaption>
        </div>
        <button id="week">Week</button><button id="month">Month</button>
        <div id="chart"></div>

        <script>
        var margin = {top: 50, left: 30, right: 20, bottom: 20},
            width = 560 - margin.left - margin.right,
            height = 300 - margin.top - margin.bottom;

        var svg = d3.select("#chart")
                  .append("svg")
                    .attr("width", width + margin.left + margin.right)
                    .attr("height", height + margin.bottom + margin.top)
                  .append("g")
                    .attr("transform", "translate(" + margin.top + "," + margin.left + ")");

        var x = d3.scaleBand().range([0,width]),
            y = d3.scaleLinear().range([height, 0]);

        var line = d3.line().x(function(d){return x(d.Weekday) + 30; })
                          .y(function(d){return y(d.Visitors)});

      d3.queue()
        .defer(d3.csv, "number.csv")
        .defer(d3.csv, "target.csv")
        .await(ready);

      function ready(error, data, tdata){


        var week = ["Mon","Tue","Wed","Thu","Fri","Sat","Sun"];

        x.domain(week);
        y.domain([0,3000]);

        svg.append("path")
           .data([data])
           .attr("class", "line")
           .attr("d", line);

        // svg.append("path")
        //    .data([tdata])
        //    .attr("class", "dottedLine")
        //    .attr("d", line);

        svg.append("g")
           .attr("class", "xaxis")
           .attr("transform", "translate(0," + height + ")")
           .call(d3.axisBottom(x)
                    .tickSize([9]));

        svg.append("g")
          .attr("class", "yaxis")
          .call(d3.axisLeft(y)
                  .ticks(6)
                  .tickSize(-width));

    //Add tooltip
      var div = d3.select("body").append("div")
            .attr("class", "tooltip")
            .style("opacity", 0);

        svg.selectAll("dot")
            .data(data)
            .enter().append("circle")
            .attr("r", 4)
            .style("fill", "white")
            .style("stroke", "#4393E6")
            .attr("cx", function(d){return x(d.Weekday) + 30;})
            .attr("cy", function(d){return y(d.Visitors); })
            .on("mouseover", function(d){
              div.transition()
                  .duration(200)
                  .style("opacity", .9);
              div.html("On " + d.Weekday + ", <span style='color: red'>" + d.Visitors + "</span> visited through social channels.")
                .style("left", (d3.event.pageX) + "px")
                .style("top", (d3.event.pageY -28) + "px");
            })
            .on("mouseout", function(d){
              div.transition()
                .duration(500)
                .style("opacity", 0);
            });

        // svg.selectAll("dot")
        //     .data(tdata)
        //     .enter().append("circle")
        //     .attr("r", 4)
        //     .attr("cx", function(d){return x(d.Year);})
        //     .attr("cy", function(d){return y(d.infections); })
        //     .style("fill", "white")
        //     .style("stroke", "#ed992f")
        //     .on("mouseover", function(d){
        //       div.transition()
        //           .duration(200)
        //           .style("opacity", .9);
        //       div.html("In " + d.Year + ", the target is <span style='color: red'>" + d.infections + "</span> new HIV infection cases")
        //         .style("left", (d3.event.pageX) + "px")
        //         .style("top", (d3.event.pageY -28) + "px");
        //     })
        //     .on("mouseout", function(d){
        //       div.transition()
        //         .duration(500)
        //         .style("opacity", 0);
        //     });   

      };

        </script>
    </div>
    <!-- End of part 1 -->






</body>
</html>