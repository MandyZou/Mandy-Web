<!DOCTYPE html>
<head>
    <title>Automative Social Activity Dashboard</title>

    <script src="https://d3js.org/d3.v4.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>

    <link rel="stylesheet" type="text/css" href="main.css"></link>
    <link rel="stylesheet" type="text/css" href="meter.css"></link>
    <link rel="stylesheet" type="text/css" href="linechart.css"></link>
    <link rel="stylesheet" type="text/css" href="donutchart.css"></link>
    <link rel="stylesheet" type="text/css" href="flipcard.css"></link>

</head>
<body onload="document.getElementById('week').focus()">

    <div class="part1">
        <div style="margin-bottom: 20px">
            <div class="gauge-all">
                <div class="gauge">
                    <div class="meter"></div>
                </div>
                <div class="needle">
                     <div class="pointer"></div>
                </div>
            </div>
        <figcaption>Total Visitors: <span style="font-size: 80px; color: #4393E6"><strong>1,200</strong></span></figcaption>
        </div>
        <button id="week">Week</button><button id="month">Month</button>
        <div id="chart"></div>

        <script>
        var margin = {top: 50, left: 20, right: 50, bottom: 20},
            width = 560 - margin.left - margin.right,
            height = 300 - margin.top - margin.bottom;

        var svg = d3.select("#chart")
                  .append("svg")
                    .attr("width", width + margin.left + margin.right)
                    .attr("height", height + margin.bottom + margin.top)
                  .append("g")
                    .attr("transform", "translate(" + (margin.top-17) + "," + margin.left + ")")

        var x = d3.scaleBand().range([0,width]),
            y = d3.scaleLinear().range([height, 0]);

        var line = d3.line().x(function(d){return x(d.Weekday) + 30; })
                          .y(function(d){return y(d.Visitors)});

      d3.queue()
        .defer(d3.csv, "number.csv")
        .defer(d3.csv, "target.csv")
        .await(ready);

      function ready(error, data, tdata){


        var week = ["Mon","Tue","Wed","Thu","Fri","Sat","Sun"];

        x.domain(week);
        y.domain([0,3000]);

        svg.append("path")
           .data([data])
           .attr("class", "line")
           .attr("d", line);

        svg.append("path")
           .data([tdata])
           .attr("class", "dottedLine")
           .attr("d", line);

        svg.append("g")
           .attr("class", "xaxis")
           .attr("transform", "translate(0," + height + ")")
           .call(d3.axisBottom(x)
                    .tickSize([9]));

        svg.append("g")
          .attr("class", "yaxis")
          .call(d3.axisLeft(y)
                  .ticks(6)
                  .tickSize(-width));

    //Add tooltip
      var div = d3.select("body").append("div")
            .attr("class", "tooltip")
            .style("opacity", 0);

        svg.selectAll("dot")
            .data(data)
            .enter().append("circle")
            .attr("r", 4)
            .style("fill", "white")
            .style("stroke", "#4393E6")
            .attr("cx", function(d){return x(d.Weekday) + 30;})
            .attr("cy", function(d){return y(d.Visitors); })
            .on("mouseover", function(d){
              div.transition()
                  .duration(200)
                  .style("opacity", .9);
              div.html("On " + d.Weekday + ", <span style='color: red'>" + d.Visitors + "</span> visited through social channels.")
                .style("left", (d3.event.pageX) + "px")
                .style("top", (d3.event.pageY -28) + "px");
            })
            .on("mouseout", function(d){
              div.transition()
                .duration(500)
                .style("opacity", 0);
            });

      };

      svg.append("g")
        .append("text")
        .attr("x", 430)
        .attr("y", 10)
        .attr("fill", "red")
        .style("font-size","10px")
        .text("Target: 2,800");

        </script>
    </div>
    <!-- End of part 1 -->

    <!-- Container of p2 and p3 -->
<div class="p2p3">
    <!-- Part 2 starts here -->
    <div class="part2">
      <div id="donut"></div>

      <script>
      var donut_width = 160,
          donut_height = 160,
          donut_margin = {top: 20, left: 40, right: 20, bottom: 20},
          radius = Math.min(width, height)/2.3;

      var svg1 = d3.select("#donut")
                  .append("svg")
                  .attr("width", donut_width + donut_margin.right + donut_margin.left)
                  .attr("height", donut_height + donut_margin.top + donut_margin.bottom)
                  .append("g")
                  .attr("transform", "translate(" + (donut_width/2 + 20) + "," + (donut_height/2 + 20) + ")");

      var svg2 = d3.select("#donut")
                  .append("svg")
                  .attr("width", donut_width + donut_margin.right + donut_margin.left)
                  .attr("height", donut_height + donut_margin.top + donut_margin.bottom)
                  .append("g")
                  .attr("transform", "translate(" + (donut_width/2 + 20) + "," + (donut_height/2 + 20) + ")");

      var svg3 = d3.select("#donut")
                  .append("svg")
                  .attr("width", donut_width + donut_margin.right + donut_margin.left)
                  .attr("height", donut_height + donut_margin.top + donut_margin.bottom)
                  .append("g")
                  .attr("transform", "translate(" + (donut_width/2 + 20) + "," + (donut_height/2 + 20) + ")");

      var percentageFormat = d3.format(",.1%");

      //for donut_tooltip1
      var donut_tooltip1 = d3.select("#donut")
                    .append("div")
                    .attr("class", "donutTooltip1");

      //for donut_tooltip2
      var donut_tooltip2 = d3.select("#donut")
                    .append("div")
                    .attr("class", "donutTooltip2");

      //for donut_tooltip3
      var donut_tooltip3 = d3.select("#donut")
                    .append("div")
                    .attr("class", "donutTooltip3");

      var color = d3.scaleOrdinal()
                    .domain(["Like","Share","Comment"])
                    .range(["#FE42AC","#4AC6FC","#FF7800"]);


      var donutWidth = 40;

      var arc = d3.arc()
                .innerRadius(radius - donutWidth)
                .outerRadius(radius);

      d3.queue()
        .defer(d3.csv, "donutnumber1.csv")
        .defer(d3.csv, "donutnumber2.csv")
        .defer(d3.csv, "donutnumber3.csv")
        .defer(d3.csv, "donutnumber4.csv")
        .await(ready);

      function ready(error, data1, data2, data3, data4){
        if(error) throw error;

        var pie = d3.pie()
                .value(function(d){return d.Count; })
                .sort(null);

        //First donut chart
        var path1 = svg1.selectAll("path")
            .data(pie(data1))
            .enter()
            .append("path")
            .attr("d", arc)
            .attr("class", "arc")
            .attr("fill", function(d){
              return color(d.data.Social);
            });

        path1.on("mouseover", function(d){
          donut_tooltip1.style("display","block").style("left", (d3.event.pageX) + "px")
                .style("top", (d3.event.pageY) + "px");
          donut_tooltip1.html("<span style='font-size: 15px'><strong>" + d.data.Social + "</strong>:</span><br/>" + d.data.Count + " Users <br/>" + percentageFormat(d.data.Percentage));
        })

        path1.on("mouseout", function(d){
          donut_tooltip1.style("display","none");
        })

        //Second donut chart
        var path2 = svg2.selectAll("path")
            .data(pie(data2))
            .enter()
            .append("path")
            .attr("d", arc)
            .attr("class", "arc2")
            .attr("fill",function(d){
              return color(d.data.Social);
            });

        path2.on("mouseover", function(d){
          donut_tooltip2.style("display","block").style("left", (d3.event.pageX) + "px")
                .style("top", (d3.event.pageY) + "px");
          donut_tooltip2.html("<span style='font-size: 15px'><strong>" + d.data.Social + "</strong>:</span><br/>" + d.data.Count + " Users <br/>" + percentageFormat(d.data.Percentage));
        })

        path2.on("mouseout", function(d){
          donut_tooltip2.style("display","none");
        })

        //Third donut chart
        var path3 = svg3.selectAll("path")
            .data(pie(data3))
            .enter()
            .append("path")
            .attr("d", arc)
            .attr("class", "arc2")
            .attr("fill",function(d){
              return color(d.data.Social);
            });

        path3.on("mouseover", function(d){
          donut_tooltip3.style("display","block").style("left", (d3.event.pageX) + "px")
                .style("top", (d3.event.pageY) + "px");
          donut_tooltip3.html("<span style='font-size: 15px'><strong>" + d.data.Social + "</strong>:</span><br/>" + d.data.Count + " Users <br/>" + percentageFormat(d.data.Percentage));
        })

        path3.on("mouseout", function(d){
          donut_tooltip3.style("display","none");
        })

        //Legend for all
        var legendRectSize = 18,
            legendSpacing = 4;

        var legendContainer = d3.select("#donut")
                                .append("svg")
                                .attr("width", 800)
                                .attr("height", legendRectSize*5);

        var legend = legendContainer.selectAll(".legend")
              .data(color.domain())
              .enter().append("g")
              .attr("class", "legend")
              .attr('transform', function(d, i) {
            var height = legendRectSize + legendSpacing;
            var offset =  height * color.domain().length;
            var horz = i * legendRectSize * 5 - offset;
            var vert = legendRectSize;
            return 'translate(' + (horz + 250) + ',' + vert + ')';
          });

          legend.append("rect")
            .attr("width", legendRectSize)
            .attr("height", legendRectSize)
            .style("fill", color)
            .style("stroke", color);

          legend.append("text")
            .attr("x", legendRectSize + legendSpacing)
            .attr("y", legendRectSize - legendSpacing +3)
            .text(function(d){return d; });


      }


      </script>
    </div>
    <!-- End of part 2 -->

    <!-- Flip cards (p3) start here -->
    <div class="container">
    <div class="main">
        <div class="front">
            <img src="car01.jpg" width="120px" style="padding-top: 10px"></img>
            <div class="text">Car Name</div>
            <div><span style="color:#4393E6">* * * * *</span></div>
        </div>
        <div class="back">
        <svg id="carchart01" height="180" width="200">
          <rect x="10" y="5" width="40" height="30" style="fill:#4393E6"/>
          <text x="125" y="25" style="font-size:15px">Facebook</text>
          <rect x="10" y="45" width="80" height="30" style="fill:#4393E6"/>
          <text x="125" y="65" style="font-size:15px">Twitter</text>
          <rect x="10" y="85" width="70" height="30" style="fill:#4393E6"/>
          <text x="125" y="105" style="font-size:15px">Google+</text>
          <rect x="10" y="125" width="10" height="30" style="fill:#4393E6"/>
          <text x="125" y="145" style="font-size:15px">Youtube</text>
        </svg>
        </div>    
    </div>
    <div class="main">
        <div class="front">
            <img src="car01.jpg" width="120px" style="padding-top: 10px"></img>
            <div class="text">Car Name</div>
            <div><span style="color:#4393E6">* * * * </span></div>
        </div>
        <div class="back">
        <svg id="carchart01" height="180" width="200">
          <rect x="10" y="5" width="100" height="30" style="fill:#4393E6"/>
          <text x="125" y="25" style="font-size:15px">Facebook</text>
          <rect x="10" y="45" width="100" height="30" style="fill:#4393E6"/>
          <text x="125" y="65" style="font-size:15px">Twitter</text>
          <rect x="10" y="85" width="20" height="30" style="fill:#4393E6"/>
          <text x="125" y="105" style="font-size:15px">Google+</text>
          <rect x="10" y="125" width="10" height="30" style="fill:#4393E6"/>
          <text x="125" y="145" style="font-size:15px">Youtube</text>
        </svg>
        </div>    
    </div>
    <div class="main">
        <div class="front">
            <img src="car01.jpg" width="120px" style="padding-top: 10px"></img>
            <div class="text">Car Name</div>
            <div><span style="color:#4393E6">* * * </span></div>
        </div>
        <div class="back">
        <svg id="carchart01" height="180" width="200">
          <rect x="10" y="5" width="90" height="30" style="fill:#4393E6"/>
          <text x="125" y="25" style="font-size:15px">Facebook</text>
          <rect x="10" y="45" width="35" height="30" style="fill:#4393E6"/>
          <text x="125" y="65" style="font-size:15px">Twitter</text>
          <rect x="10" y="85" width="23" height="30" style="fill:#4393E6"/>
          <text x="125" y="105" style="font-size:15px">Google+</text>
          <rect x="10" y="125" width="80" height="30" style="fill:#4393E6"/>
          <text x="125" y="145" style="font-size:15px">Youtube</text>
        </svg>
        </div>    
    </div>
    <div class="main">
        <div class="front">
            <img src="car01.jpg" width="120px" style="padding-top: 10px"></img>
            <div class="text">Car Name</div>
            <div><span style="color:#4393E6">* * </span></div>
        </div>
        <div class="back">
        <svg id="carchart01" height="180" width="200">
          <rect x="10" y="5" width="90" height="30" style="fill:#4393E6"/>
          <text x="125" y="25" style="font-size:15px">Facebook</text>
          <rect x="10" y="45" width="90" height="30" style="fill:#4393E6"/>
          <text x="125" y="65" style="font-size:15px">Twitter</text>
          <rect x="10" y="85" width="23" height="30" style="fill:#4393E6"/>
          <text x="125" y="105" style="font-size:15px">Google+</text>
          <rect x="10" y="125" width="80" height="30" style="fill:#4393E6"/>
          <text x="125" y="145" style="font-size:15px">Youtube</text>
        </svg>
        </div>    
    </div>
    <div class="main">
        <div class="front">
            <img src="car01.jpg" width="120px" style="padding-top: 10px"></img>
            <div class="text">Car Name</div>
            <div><span style="color:#4393E6">* </span></div>
        </div>
        <div class="back">
        <svg id="carchart01" height="180" width="200">
          <rect x="10" y="5" width="70" height="30" style="fill:#4393E6"/>
          <text x="125" y="25" style="font-size:15px">Facebook</text>
          <rect x="10" y="45" width="35" height="30" style="fill:#4393E6"/>
          <text x="125" y="65" style="font-size:15px">Twitter</text>
          <rect x="10" y="85" width="70" height="30" style="fill:#4393E6"/>
          <text x="125" y="105" style="font-size:15px">Google+</text>
          <rect x="10" y="125" width="10" height="30" style="fill:#4393E6"/>
          <text x="125" y="145" style="font-size:15px">Youtube</text>
        </svg>
        </div>    
    </div>
    <div class="main">
        <div class="front">
            <img src="car01.jpg" width="120px" style="padding-top: 10px"></img>
            <div class="text">Car Name</div>
            <div><span style="color:#4393E6"> * </span></div>
        </div>
        <div class="back">
        <svg id="carchart01" height="180" width="200">
          <rect x="10" y="5" width="20" height="30" style="fill:#4393E6"/>
          <text x="125" y="25" style="font-size:15px">Facebook</text>
          <rect x="10" y="45" width="35" height="30" style="fill:#4393E6"/>
          <text x="125" y="65" style="font-size:15px">Twitter</text>
          <rect x="10" y="85" width="23" height="30" style="fill:#4393E6"/>
          <text x="125" y="105" style="font-size:15px">Google+</text>
          <rect x="10" y="125" width="80" height="30" style="fill:#4393E6"/>
          <text x="125" y="145" style="font-size:15px">Youtube</text>
        </svg>
        </div>    
    </div>
</div>
<!-- part 3 ends here -->
</div>
<!-- p2p3 ends here -->


    <!-- Flip cards end  -->
</body>
</html>