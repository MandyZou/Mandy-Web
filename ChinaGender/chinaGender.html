<html>
<head>
    <title>How China Performs in Gender Difference?</title>

    <script src="https://d3js.org/d3.v4.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
</head>

<body>
    <div id="gg-all"></div>

    <script>
    var margin = {top: 20, left: 20, right: 20, bottom: 20},
        width = 1000 - margin.left - margin.right,
        height = 100 - margin.top - margin.bottom;

    var svg_all = d3.select("#gg-all")
                    .append("svg")
                        .attr("width", width + margin.left + margin.right)
                        .attr("height", height + margin.top + margin.bottom)
                    .append("g")
                    .attr("transform", "translate(" + margin.top + "," + margin.left + ")");

    d3.queue()
        .defer(d3.csv, "China_all.csv", type)
        .await(ready);

    function ready(error, data){
        if(error) throw error;

        var x = d3.scaleLinear()
                // .domain(d3.extent(data, function(d){ return d.Global; }))
                .domain([0.5,0.8])
                .range([0, width]);

        svg_all.selectAll(".bar")
                .data(data)
            .enter().append("rect")
                .attr("x", function(d){
                    if(d.Global > 0){
                        return x(d.Global);
                    } else {
                        return x(0);
                    }
                })
                .attr("width", 5)
                .attr("y", 30)
                .attr("height", 60)
                .attr("class", function(d){return d.Countries; })
                .attr("fill","rgba(201, 201, 201,0.6)");

//Append text here
        svg_all.selectAll("text.bar")
            .data(data)
        .enter().append("text")
            .attr("class", function(d){return d.Countries + "-text"; })
            .attr("text-anchor","middle")
            .attr("x", function(d){
                    if(d.Global > 0){
                        return x(d.Global);
                    } else {
                        return x(0);
                    }
                })
            .attr("y", 25)
            .text(function(d){return d.Global});

        svg_all.append("g")
            .attr("transform", "translate(0," + height + ")")
            .call(d3.axisBottom(x)
                    .ticks(0)
                    .tickSize(0));

    };

    function type(d) {
    d.Global = +d.Global;
    return d;
    }

    </script>

</body>
</html>