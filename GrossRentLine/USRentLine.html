<!DOCTYPE html>
<head>
    <title>Median Gross Rent Line Graph</title>
    <script src="https://d3js.org/d3.v4.min.js"></script>

    <script type="text/javascript" src="http://media.flowingdata.com/js/jquery-1.4.4.min.js"></script>


    <style>
    .line {
      fill: none;
      stroke: #CCCCCC;
      stroke-width: 2px;
    }

    .selected {
        stroke: #09C909;
    }
    </style>
</head>

<body>
  <h1 style="padding-left: 20px;">Median Bedroom Gross Rent by States from 2010 to 2015</h1>
  <svg id="rentLine" width = "960" height = "960"></svg>

  <script>
  var margin = {top: 20, bottom: 20, left: 50, right: 20},
      height = 960 - margin.top - margin.bottom,
      width = 960 - margin.left - margin.right;

  var states = ["State", "Alabama","Alaska","Arizona","Arkansas","California","Colorado","Connecticut","Delaware","District of Columbia","Florida","Georgia","Hawaii","Idaho","Illinois","Indiana","Iowa","Kansas","Kentucky","Louisiana","Maine","Maryland","Massachusetts","Michigan","Minnesota","Mississippi","Missouri","Montana","Nebraska","Nevada","New Hampshire","New Jersey","New Mexico","New York","North Carolina","North Dakota","Ohio","Oklahoma","Oregon","Pennsylvania","Rhode Island","South Carolina","South Dakota","Tennessee","Texas","Utah","Vermont","Virginia","Washington","West Virginia","Wisconsin","Wyoming","Puerto Rico"];

  var state = {};

  var years = [2015,2014,2013,2012,2011,2010];

  var x = d3.scaleLinear().range([0, width]),
      y = d3.scaleLinear().range([height, 0]);

  //Set up svg
  var svg = d3.select("#rentLine")
          .append("svg")
              .attr("width", width + margin.left + margin.right)
              .attr("height", height + margin.top + margin.bottom)
          .append("g")
              .attr("transform", "translate(" + margin.left + "," + margin.top +")");

  d3.queue()
    .defer(d3.text, "grossrent4.csv")
    .await(ready);

  function ready(error, data){
    if (error) throw error;

    var text = d3.csvParseRows(data);

    for(i=1;i<states.length;i++){
        //Slice all the y numbers out
        var values=text[i].slice(1,text[i.length]);
          // console.log(values);
        var currData =[];state[states[i]] = states[i];
        //*Important* step to puy each year and each value together
        for(j=0;j<values.length;j++){
          currData.push({x: years[j], y: values[j]});
          };

        var line = d3.line().x(function(d,i){return x(d.x);}).y(function(d){return y(d.y);});

        x.domain([2010, 2015]);
        y.domain([400, 1500]);


        svg.append("path")
            .data([currData])
            .attr("state", states[i])
            .attr("class", "line")
            .attr("d", line)
            .on("mouseover", function(d){
                d3.select(this).classed("selected", true);
            })
            .on("mouseout", function(d){
                d3.select(this).classed("selected", false);
            });


        svg.append("g")
            .attr("transform", "translate(0," + height + ")")
            .call(d3.axisBottom(x)
                .ticks(5)
                .tickFormat(d3.format("")));

        svg.append("g")
            .call(d3.axisLeft(y));

      }};
        

  </script>

</body>
</html>