<!DOCTYPE html>
<head>
    <title>Missing Children</title>

    <script src="https://d3js.org/d3.v4.min.js"></script>
    <script src="https://d3js.org/d3-selection-multi.v1.min.js"></script>

    <!-- Introducing TopoJson -->
    <script src="https://unpkg.com/topojson@3.0.0"></script>

    <script src="https://d3js.org/d3-scale-chromatic.v1.min.js"></script>

    <link href="https://fonts.googleapis.com/css?family=Special+Elite" rel="stylesheet">

    <style>
    body {
        font-family: 'Special Elite', cursive;
    }
    h1{
        margin: 0;
        padding-bottom: 5px;
    }

    #childMap{
        width: 2000px;
        height: 630px;
    }

    .chart {
        padding-left: 30px;
    }

    .states {
        fill: #ddd;
        stroke: white;
        stroke-width: 1.5px;
    }

    .yaxis .domain{
        display: none;
    }

    .tick text{
        fill: #999;
    }

    .xaxis line{
        fill: none;
        stroke:#999;
        shape-rendering: crispEdges;
    }

    .xaxis .domain{
        stroke: #999;
    }

    </style>
</head>

<body>
    <div id="childMap">
        <h1>Lost Children by States over Last 10 Years</h1>
    </div>
    <script>
    var margin = {top: 60, left: 10, right: 1000, bottom: 30},
        height = 600 - margin.top - margin.bottom,
        width = 1500 - margin.left - margin.right,
        box_w = ((width - margin.left) / 52) + 80;

    var svg = d3.select("#childMap")
                .append("svg")
                .attr("height", height + margin.top + margin.bottom)
                .attr("width", width + margin.left + margin.right)
                .attr("class","chart")
                .append("g")
                .attr("transform", "translate(" + margin.left + "," + margin.top +")");

    var x = d3.scaleBand().range([0, (box_w + 1) * 12]),
        y = d3.scaleLinear().range([height,0]);

    var color = d3.scaleOrdinal(d3.schemeCategory20c);

    var tip = d3.select("body")
        .append("div")
        .style("position", "absolute")
        .style("z-index", "10")
        .style("visibility", "hidden")
        .style("color", "#2c2c2c")
        .style("padding", "8px")
        .style("background-color", "rgba(255, 255, 255, 0.75)")
        .style("border", "solid 1px #2c2c2c")
        .style("border-radius", "6px")
        .style("font", "12px sans-serif")
        .text("tooltip");

    d3.queue()
        .defer(d3.csv, "childoutput.csv")
        .await(ready);

    function ready(error, data){
        if (error) throw error;

        x.domain(["AL","AK","AZ","AR","CA","CO","CT","DE","DC","FL","GA","GU","HI","ID","IL","IN","IA","KS","KY","LA","ME","MD","MH","MA","MI","MN","MS","MO","MT","NE","NV","NH","NJ","NM","NY","NC","ND","OH","OK","OR","PW","PA","SC","SD","TN","TX","UT","VA","WA","WV","WI","WY"]);
        y.domain([2008,2017]);

        // console.log(typeof(domain))

        for (var i = 0; i<data.length; i++){

        var radiusScale = d3.scaleSqrt().domain([0, 144])
                                        .range([1,15]);

        // console.log(data)

        svg.selectAll("circle")
            .data(data)
            .enter().append("circle")
                .attr("cx", function(d,i){return x(d.State); })
                .attr("cy", function(d,i){return y(d.Year)})
                .attr("r", function(d){
                return radiusScale(d.Number);
                })
            .style("fill", function(d){return color(d.Year);})
            .on("mouseover", function(d){
                tip.html(d.stateName + ": <br/>" + d.Number + " children in " + d.Year);
                // console.log(d.State)
                tip.style("visibility", "visible");
                tip.style("top", (d3.event.pageY-10)+"px").style("left",(d3.event.pageX+10)+"px");
            })
            .on("mouseout", function(d){
                return tip.style("visibility","hidden");
            });
            // .append("g")
            // .attr("transform","translate(300, 90)");

        svg.append("g")
            .attr("class", "xaxis")
            .attr("transform","translate(-8," + (height-530) + ")")
            .call(d3.axisTop(x)
                        .tickSize([3]));

        svg.append("g")
            .attr("class","yaxis")
            .attr("transform","translate(" + (width*2.27) + ",0)")
            .call(d3.axisLeft(y)
                    .tickSize([0])
                    // .tickPadding([10])
                    .tickFormat(d3.format("")));


         

    }; //End of i loop
        

    };




    </script>
<p style="padding-top: 8px"><em>*2017 Data only includes January to March.</em></p>
<p><em>Source: data.world</em></p>

</body>
</html>