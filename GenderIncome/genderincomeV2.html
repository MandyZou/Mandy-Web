<!DOCTYPE html>
<meta charset="utf-8">
<head>
    <title>Education v. Income: Gender Gap</title>

    <script src="http://d3js.org/d3.v4.min.js"></script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>

    <link rel="stylesheet"
  href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.5.2/animate.min.css">

<style>
    #chart {
        width: 800px;
        height: 600px;
    }

</style>

</head>

<body>
    <h1>Income Gender Gap by Degrees</h1>
    <div id="chart"></div>
    <div id="chart2"></div>
    <button id="2015">2015</button>
    <button id="2014">2014</button>
    <button id="2013">2013</button>
    <button id="2012">2012</button>
    <button id="2011">2011</button>
    <button id="2010">2010</button>
    <script>
        var margin = {top: 20, left: 20, right: 20, bottom: 20},
            width = 600 - margin.left - margin.right,
            height = 600 - margin.top - margin.bottom;

        var x = d3.scaleLinear()
                .domain([0,85000])
                .range([0,width]),
            y = d3.scaleBand()
                  .domain(["Less than high school graduate","High school graduate (includes equivalency)","Some college or associate's degree","Bachelor's degree","Graduate or professional degree","All"]).padding([0.1])
                  .range([height, 0]);

        var svg = d3.select("#chart")
                    .append("svg")
                    .attr("width", width + margin.left + margin.right)
                    .attr("height", height + margin.top + margin.bottom)
                    .append("g")
                    .attr("transform","translate(" + margin.left + "," + margin.top + ")"); 

        svg.append("g")
                .attr("class","xaxis")
                .attr("transform","translate(0," + height + ")")
                .call(d3.axisBottom(x));         

//for male
        d3.csv("male.csv", function(error, mdata){
            if (error) throw error;

            // console.log(mdata)

            d3.selectAll("button")
                .on("click", function(){
                    draw(this.id);
                });

            // draw("2014");

            function draw(myYear){

            var newData = mdata.filter(function(d){return d.Year == myYear; })

            console.log(newData)

            var bars = svg.selectAll(".bar")
                        .data(newData);

            bars.exit()
                .transition()
                .duration(1000)
                .attr("width", 0)
                .remove();

            bars.enter()
                .append("rect")
                .attr("class","bar")
                .attr("x", 0)
                .attr("y", function(d){return y(d.Degree); })
                .attr("width", 0)
                .attr("height", y.bandwidth())
                .attr("fill","teal")
                .merge(bars).transition()
                .duration(1000)
                .attr("y", function(d){return y(d.Degree); })
                .attr("width", function(d){return x(d.Income); });

            bars.on("mouseover", function(d){console.log(d)});


             };
            });

//female 
     var svg2 = d3.select("#chart2")
                    .append("svg")
                    .attr("width", width + margin.left + margin.right)
                    .attr("height", height + margin.top + margin.bottom)
                    .append("g")
                    .attr("transform","translate(" + margin.left + "," + margin.top + ")"); 

        svg2.append("g")
                .attr("class","xaxis")
                .attr("transform","translate(0," + height + ")")
                .call(d3.axisBottom(x));         

    d3.csv("female.csv", function(error, mdata){
            if (error) throw error;

            // console.log(mdata)

            d3.selectAll("button")
                .on("click", function(){
                    draw(this.id);
                });

            // draw("2014");

            function draw(myYear){

            var newData = mdata.filter(function(d){return d.Year == myYear; })

            console.log(newData)

            var bars = svg2.selectAll(".bar")
                        .data(newData);

            bars.exit()
                .transition()
                .duration(1000)
                .attr("width", 0)
                .remove();

            bars.enter()
                .append("rect")
                .attr("class","bar")
                .attr("x", 0)
                .attr("y", function(d){return y(d.Degree); })
                .attr("width", 0)
                .attr("height", y.bandwidth())
                .attr("fill","teal")
                .merge(bars).transition()
                .duration(1000)
                .attr("y", function(d){return y(d.Degree); })
                .attr("width", function(d){return x(d.Income); });

            bars.on("mouseover", function(d){console.log(d)});


             };
            });



//Resources: https://stackoverflow.com/questions/39431032/using-d3-filter-in-an-update-function


    </script>

</body>
</html>